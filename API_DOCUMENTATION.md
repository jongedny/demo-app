# API Documentation

## Overview

The Another Read API provides external access to content generated by the application. This API uses API key authentication to ensure secure access.

## Authentication

All API requests require a valid API key. Include your API key in the request parameters.

### Getting an API Key

1. Log in to the Another Read admin panel
2. Navigate to **API Keys** in the sidebar (Admin only)
3. Click **Create API Key**
4. Give your key a descriptive name (e.g., "Production Website")
5. Copy the generated key immediately - it will only be shown once!

API keys follow the format: `ar_live_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`

## Endpoints

### Get Content

Retrieve content with pagination support.

**Endpoint:** `api.getContent`

**Method:** Query

**Parameters:**

| Parameter | Type   | Required | Description                           |
|-----------|--------|----------|---------------------------------------|
| apiKey    | string | Yes      | Your API key                          |
| limit     | number | No       | Number of items to return (1-100, default: 50) |
| offset    | number | No       | Number of items to skip (default: 0)  |

**Example Request (tRPC):**

```typescript
import { createTRPCProxyClient, httpBatchLink } from '@trpc/client';
import type { AppRouter } from '~/server/api/root';

const client = createTRPCProxyClient<AppRouter>({
  links: [
    httpBatchLink({
      url: 'https://your-domain.com/api/trpc',
    }),
  ],
});

const result = await client.api.getContent.query({
  apiKey: 'ar_live_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
  limit: 10,
  offset: 0,
});

console.log(result.data); // Array of content items
```

**Example Request (HTTP):**

```bash
curl -X GET 'https://your-domain.com/api/trpc/api.getContent?input=%7B%22apiKey%22%3A%22ar_live_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx%22%2C%22limit%22%3A10%2C%22offset%22%3A0%7D'
```

**Response:**

```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "eventId": 5,
      "title": "Sample Content Title",
      "content": "Content body text...",
      "relatedBookIds": "[1, 2, 3]",
      "createdAt": "2025-12-10T16:00:00.000Z"
    }
  ],
  "pagination": {
    "limit": 10,
    "offset": 0,
    "count": 10
  }
}
```

## Response Codes

| Code | Description |
|------|-------------|
| 200  | Success |
| 401  | Unauthorized - Invalid API key |
| 403  | Forbidden - API key has been revoked |
| 500  | Internal server error |

## Rate Limiting

Currently, there are no rate limits enforced. However, we track usage statistics for each API key.

## Best Practices

1. **Keep your API key secure** - Never commit it to version control or expose it in client-side code
2. **Use environment variables** - Store your API key in environment variables
3. **Monitor usage** - Check the API Keys page regularly to monitor usage statistics
4. **Revoke compromised keys** - If you suspect your key has been compromised, revoke it immediately and create a new one
5. **Use pagination** - For large datasets, use the limit and offset parameters to paginate results

## Support

For API support or to report issues, please contact your system administrator.
